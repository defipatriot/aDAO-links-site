<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alliance DAO Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Vercel Analytics Script -->
    <script>
     window.va = window.va || function () { (window.va.q = window.va.q || []).push(arguments); };
    </script>
    <script src="/_vercel/insights/script.js" defer></script>
    
    <style>
        /* --- Base Styles --- */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #0D0D0D;
            color: #EAEAEA;
        }

        /* --- Card Styles --- */
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            /* backdrop-filter: blur(10px); */ /* PERFORMANCE: Commented out, this is very expensive */
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .stat-card:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(45, 212, 191, 0.5);
        }
        .info-card {
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 1.5rem;
        }
        .info-card .icon {
            font-size: 1.75rem;
            margin-bottom: 0.75rem;
            color: #2dd4bf; /* teal-400 */
        }
        .info-card h3 {
            font-size: 1.125rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 0.5rem;
        }
        .info-card p, .info-card .link-text {
            font-size: 0.875rem;
            color: #9ca3af; /* gray-400 */
            line-height: 1.5;
            flex-grow: 1; /* Allows text to take up space */
        }
         .info-card .link-group {
            margin-top: 1rem;
        }
        .info-card a:hover .link-text, .info-card a:hover h3, .info-card .link-text a:hover {
            color: #2dd4bf;
        }
        .stat-card .subtext {
            min-height: 1.25rem; /* Ensures space is reserved for subtext */
        }

        /* --- Slider Styles --- */
        .slider-bar {
            display: flex;
            height: 0.75rem;
            border-radius: 9999px;
            overflow: hidden;
            position: relative;
        }
        .slider-fill-blue {
            background: linear-gradient(90deg, #00F2FE, #2889FC);
        }
        .slider-fill-gray {
            background-color: #374151; /* gray-700 */
        }

        /* --- Pulse Animation for Live Proposals --- */
        .pulse-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #4ade80; /* green-400 */
            animation: pulse 2s infinite;
            /* box-shadow: 0 0 0 0 rgba(74, 222, 128, 1); */ /* PERFORMANCE: Removed expensive shadow animation */
        }
        @keyframes pulse {
            0% { transform: scale(0.95); /* box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.7); */ }
            70% { transform: scale(1); /* box-shadow: 0 0 0 10px rgba(74, 222, 128, 0); */ }
            100% { transform: scale(0.95); /* box-shadow: 0 0 0 0 rgba(74, 222, 128, 0); */ }
        }

        /* --- Red Static Dot for No Proposals --- */
        .static-dot-red {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ef4444; /* red-500 */
        }
        
        /* --- Modal Styles (Generic) --- */
        .modal {
            transition: opacity 0.3s ease;
        }
        .modal.hidden {
            pointer-events: none;
        }
        .modal .modal-content {
            transition: transform 0.3s ease, opacity 0.3s ease;
            max-height: 90vh; /* Keep overall max height */
        }
        .modal.hidden .modal-content {
            transform: scale(0.95);
            opacity: 0;
        }

        /* --- NFT Explorer Modal Styles --- */
         .modal-backdrop {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex; align-items: center; justify-content: center;
            z-index: 50; 
            /* backdrop-filter: blur(4px); */ /* PERFORMANCE: Commented out, expensive */
        }
        .modal-content-explorer { /* Renamed to avoid conflict */
            background-color: #1f2937; border: 1px solid #4b5563;
            border-radius: 0.75rem; padding: 1.5rem;
            max-width: 90vw; max-height: 90vh;
            width: 500px; /* Specific width from explorer */
            overflow-y: auto;
            position: relative;
        }
        .modal-close-btn {
            position: absolute; top: 1rem; right: 1rem;
            color: #9ca3af; cursor: pointer;
        }
        .modal-close-btn:hover { color: #e5e7eb; }
        .control-btn { /* Style for download button */
            background-color: #374151; /* gray-700 */
            color: #e5e7eb; /* gray-200 */
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #4b5563; /* gray-600 */
            transition: background-color 0.2s;
            font-weight: 500;
        }
        .control-btn:hover:not(:disabled) {
            background-color: #4b5563; /* gray-600 */
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header Section -->
    <header class="py-4">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <!-- Left: Logo (Not a link on the dashboard page) -->
            <div class="flex-shrink-0 w-32">
                 <!-- Use a placeholder that roughly matches the logo size -->
                <img src="https://raw.githubusercontent.com/defipatriot/aDAO-Image-Files/main/Alliance%20DAO%20Logo.png" alt="Alliance DAO Logo" class="h-16 w-auto" onerror="this.src='https://placehold.co/128x64/0D0D0D/EAEAEA?text=Logo'; this.onerror=null;">
            </div>
            <!-- Center: Navigation Tiles -->
            <nav class="flex-1 flex justify-center items-center space-x-6">
                <a href="nft-explorer.html" class="bg-gray-800/50 hover:bg-gray-700/80 border border-gray-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-all transform hover:scale-105">
                    NFT Explorer
                </a>
                 <!-- Removed Galaxy Map link temporarily -->
                 
                <a href="planet-map.html" class="bg-gray-800/50 hover:bg-gray-700/80 border border-gray-700 text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-all transform hover:scale-105">
                    Galaxy Map
                </a>
                
            </nav>
            <!-- Right: Terra Logo -->
            <div class="w-32 flex-shrink-0 flex justify-end">
                 <!-- Use a placeholder that roughly matches the logo size -->
                <img src="https://raw.githubusercontent.com/defipatriot/aDAO-Image-Planets-Empty/main/Terra.PNG" alt="Terra Logo" class="h-16 w-auto" onerror="this.src='https://placehold.co/128x64/0D0D0D/EAEAEA?text=Logo'; this.onerror=null;">
            </div>
        </div>
    </header>

    <!-- CoinGecko Price Marquee -->
    <div class="py-2 border-b border-gray-800">
        <script src="https://widgets.coingecko.com/gecko-coin-price-marquee-widget.js"></script>
<gecko-coin-price-marquee-widget locale="en" dark-mode="true" outlined="true" coin-ids="terra-luna-2,eris-amplified-luna,eris-arbitrage-luna,backbone-labs-staked-luna,lion-dao,capapult,solid-2,astroport-fi,eureka-bridged-wbtc-terra,cosmos,ethereum" initial-currency="usd"></gecko-coin-price-marquee-widget>
    </div>


    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Disclaimer Banner -->
        <div id="disclaimer-banner" class="bg-yellow-500/10 border border-yellow-400/30 text-yellow-300 px-4 py-3 rounded-lg relative mb-8 text-center" role="alert">
            <strong class="font-bold">Please Note:</strong>
            <span class="block sm:inline">Tiles with a <span class="inline-block w-2.5 h-2.5 rounded-full bg-red-500 mx-1 align-middle"></span> are from a snapshot. Tiles with a <span class="inline-block w-2.5 h-2.5 rounded-full bg-green-400 mx-1 align-middle"></span> are from a live feed.</span>
            <span id="close-banner" class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer">
                <svg class="fill-current h-6 w-6 text-yellow-400" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><title>Close</title><path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1-1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1-1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/></svg>
            </span>
        </div>

        <!-- Top Info Cards Section -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <a href="ally.html" class="stat-card info-card rounded-xl group">
                <i class="fas fa-layer-group icon"></i>
                <h3 class="group-hover:text-teal-400">ALLY Rewards</h3>
                <p>A pioneering collection backed by LUNA staking rewards. Your share of the pool grows as others claim theirs.</p>
                <span class="link-text link-group">Learn More &rarr;</span>
            </a>
            <div class="flex flex-col gap-4">
                 <a href="tutorials.html" class="stat-card info-card rounded-xl group flex-1">
                      <i class="fas fa-video icon !mb-2"></i>
                      <h3 class="group-hover:text-teal-400 !mb-0">Tutorials & Guides</h3>
                 </a>
                 <a href="news.html" class="stat-card info-card rounded-xl group flex-1">
                      <i class="fas fa-newspaper icon !mb-2"></i>
                      <h3 class="group-hover:text-teal-400 !mb-0">Ecosystem News</h3>
                 </a>
            </div>
             <div class="flex flex-col gap-4">
                <a href="rarity-explained.html" class="stat-card info-card rounded-xl group flex-1">
                     <i class="fas fa-gem icon !mb-2"></i>
                     <h3 class="group-hover:text-teal-400 !mb-0">Rarity Info</h3>
                </a>
                <a href="release-history.html" class="stat-card info-card rounded-xl group flex-1">
                     <i class="fas fa-stream icon !mb-2"></i>
                     <h3 class="group-hover:text-teal-400 !mb-0">NFT Release History</h3>
                </a>
            </div>
            <div class="flex flex-col gap-4">
                <a href="links.html" class="stat-card info-card rounded-xl group flex-1">
                     <i class="fas fa-link icon !mb-2"></i>
                     <h3 class="group-hover:text-teal-400 !mb-0">Official Links</h3>
                </a>
                <a href="alliances.html" class="stat-card info-card rounded-xl group flex-1">
                     <i class="fas fa-handshake icon !mb-2"></i>
                     <h3 class="group-hover:text-teal-400 !mb-0">Our Alliances</h3>
                </a>
            </div>
        </div>
        
        <!-- Status Sliders Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
            <!-- Mint Status -->
            <div class="stat-card p-4 rounded-xl">
                <div class="flex justify-between items-center text-sm font-medium text-gray-300">
                    <span>Un-minted</span>
                    <h3 class="text-base font-semibold text-gray-400">Mint Status</h3>
                    <span>Minted</span>
                </div>
                <div id="mint-slider" class="slider-bar mt-2">
                    <!-- Slider will be generated by JS -->
                </div>
                <div class="flex justify-between text-sm font-bold text-white mt-2">
                    <span id="unminted-count"><i class="fas fa-spinner fa-spin text-white"></i></span>
                    <span id="minted-percent" class="text-center text-cyan-400"><i class="fas fa-spinner fa-spin text-cyan-400"></i></span>
                    <span id="minted-count"><i class="fas fa-spinner fa-spin text-white"></i></span>
                </div>
            </div>
            <!-- Broken Status -->
            <div class="stat-card p-4 rounded-xl">
                <div class="flex justify-between items-center text-sm font-medium text-gray-300">
                    <span>Un-Broken</span>
                    <h3 class="text-base font-semibold text-gray-400">Broken Status</h3>
                    <span>Broken</span>
                </div>
                <div id="broken-slider" class="slider-bar mt-2">
                    <!-- Slider will be generated by JS -->
                </div>
                <div class="flex justify-between text-sm font-bold text-white mt-2">
                    <span id="unbroken-count"><i class="fas fa-spinner fa-spin text-white"></i></span>
                    <div class="text-center">
                        <p id="broken-percent" class="text-cyan-400 text-xs"><i class="fas fa-spinner fa-spin text-cyan-400"></i></p>
                    </div>
                    <span id="broken-count"><i class="fas fa-spinner fa-spin text-white"></i></span>
                </div>
            </div>
        </div>

        <!-- Historical Charts Link -->
        <a href="graphs.html" class="stat-card rounded-xl group flex items-center justify-center text-center p-6 mb-8">
             <i class="fas fa-chart-line icon mr-4"></i>
             <div>
                 <h3 class="text-xl font-bold group-hover:text-teal-400">View Historical Data & Charts</h3>
                 <p class="text-gray-400">Explore detailed charts on backing, sales, and forward-looking projections.</p>
             </div>
        </a>

        <!-- Key Metrics Section -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
            <!-- ROW 1 -->
            <div id="daodao-staked-card" class="stat-card p-6 rounded-xl text-center cursor-pointer group">
                <div>
                    <h3 id="daodao-staked-title" class="text-md font-medium text-gray-400 flex justify-center items-center gap-2 group-hover:text-teal-400">DAODAO Staked</h3>
                    <p id="daodao-staked" class="text-3xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                    <p id="daodao-staked-percentage" class="text-base font-semibold text-cyan-400 mt-1">&nbsp;</p>
                </div>
                <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click to see details</p>
            </div>
            <div id="enterprise-staked-card" class="stat-card p-6 rounded-xl text-center cursor-pointer group">
                <div>
                    <h3 id="enterprise-staked-title" class="text-md font-medium text-gray-400 flex justify-center items-center gap-2 group-hover:text-teal-400">Enterprise Staked</h3>
                    <p id="enterprise-staked-holder" class="text-3xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                </div>
                <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click to see details</p>
            </div>
            <a href="https://daodao.zone/dao/terra1sffd4efk2jpdt894r04qwmtjqrrjfc52tmj6vkzjxqhd8qqu2drs3m5vzm/members" target="_blank" rel="noopener noreferrer" class="stat-card p-6 rounded-xl text-center group">
                <div>
                    <h3 id="dao-members-title" class="text-md font-medium text-gray-400 flex justify-center items-center gap-2">DAO Members</h3>
                    <p id="dao-members" class="text-3xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                </div>
                 <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click link to site</p>
            </a>
            <div id="dao-broken-card" class="stat-card p-6 rounded-xl text-center cursor-pointer group">
                 <div>
                    <h3 class="text-md font-medium text-gray-400 group-hover:text-teal-400">DAO Broken/Held NFTs</h3>
                    <p id="dao-broken-total" class="text-3xl font-bold text-white mt-2">1,000</p>
                </div>
                 <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click to see details</p>
            </div>
            <!-- ROW 2 -->
            <div id="dao-treasury-card" class="stat-card p-6 rounded-xl text-center cursor-pointer group">
                <div>
                    <h3 id="dao-treasury-title" class="text-md font-medium text-gray-400 group-hover:text-teal-400 flex justify-center items-center gap-2">DAO Treasury</h3>
                    <p id="dao-treasury-total" class="text-3xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                </div>
                <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click to see details</p>
            </div>
             <div id="dao-tla-card" class="stat-card p-6 rounded-xl text-center cursor-pointer group">
                <div>
                    <h3 id="dao-tla-title" class="text-md font-medium text-gray-400 group-hover:text-teal-400 flex justify-center items-center gap-2">DAO TLA Deposits</h3>
                    <p id="dao-tla-total" class="text-3xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                    <p id="dao-tla-apr" class="text-base font-semibold text-gray-300"><i class="fas fa-spinner fa-spin text-gray-300"></i></p>
                </div>
                 <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click to see details</p>
            </div>
             <div id="dao-tla-vp-card" class="stat-card p-6 rounded-xl text-center cursor-pointer group">
                 <div>
                    <h3 id="dao-tla-vp-title" class="text-md font-medium text-gray-400 group-hover:text-teal-400 flex justify-center items-center gap-2">DAO TLA VP</h3>
                    <p id="dao-tla-vp" class="text-xl font-bold text-white mt-2">Details</p>
                    <p id="dao-tla-vp-usd" class="text-base font-semibold text-gray-300"><i class="fas fa-spinner fa-spin text-gray-300"></i></p>
                </div>
                 <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click to see details</p>
            </div>
            <div id="unminted-backing-card" class="stat-card p-6 rounded-xl text-center cursor-pointer group">
                 <div>
                    <h3 id="unminted-nft-backing-title" class="text-md font-medium text-gray-400 group-hover:text-teal-400 flex justify-center items-center gap-2">Unminted NFT Backing</h3>
                    <p id="unminted-nft-backing-luna" class="text-xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-xl"></i></p>
                    <p id="unminted-nft-backing-usd" class="text-base font-semibold text-gray-300"><i class="fas fa-spinner fa-spin text-gray-300"></i></p>
                </div>
                 <p class="subtext text-xs font-semibold mt-1 text-gray-500">Click to see details</p>
            </div>

            <!-- ROW 3 -->
            <div class="stat-card p-6 rounded-xl text-center">
                <div>
                    <h3 id="backing-ampluna-title" class="text-md font-medium text-gray-400 flex justify-center items-center gap-2">Backing in ampLUNA</h3>
                    <div class="flex justify-center items-center gap-2 mt-2">
                        <p id="backing-per-nft-ampluna" class="text-3xl font-bold text-white"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                         <!-- Use a placeholder that roughly matches the logo size -->
                        <img src="https://raw.githubusercontent.com/defipatriot/aDAO-Image-Files/main/ampLuna.webp?raw=true" alt="ampLUNA" class="h-8 w-8" onerror="this.src='https://placehold.co/32x32/1f2937/EAEAEA?text=AL'; this.onerror=null;">
                    </div>
                </div>
                 <!-- Corrected subtext ID for ampLUNA Ratio -->
                 <p id="backing-per-nft-change" class="subtext text-xs font-semibold mt-1 text-gray-500"><i class="fas fa-spinner fa-spin text-gray-500"></i></p>
            </div>
            <div class="stat-card p-6 rounded-xl text-center">
                <div>
                    <h3 id="backing-luna-live-title" class="text-md font-medium text-gray-400 flex justify-center items-center gap-2">Backing in LUNA</h3>
                    <div class="flex justify-center items-center gap-2 mt-2">
                        <p id="backing-per-nft-luna-live" class="text-3xl font-bold text-white"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                         <!-- Use a placeholder that roughly matches the logo size -->
                        <img src="https://raw.githubusercontent.com/defipatriot/aDAO-Image-Files/main/Luna.webp?raw=true" alt="LUNA" class="h-8 w-8" onerror="this.src='https://placehold.co/32x32/1f2937/EAEAEA?text=L'; this.onerror=null;">
                    </div>
                </div>
                <!-- Corrected subtext ID for LUNA Tile -->
                <p id="live-ampluna-price-luna" class="subtext text-xs font-semibold mt-1 text-gray-500">&nbsp;</p> <!-- Was showing Rate here, now empty -->
            </div>
            <div class="stat-card p-6 rounded-xl text-center">
                <div>
                    <h3 id="backing-usd-title" class="text-md font-medium text-gray-400 flex justify-center items-center gap-2">Backing in USD</h3>
                    <p id="backing-per-nft-usd" class="text-3xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                </div>
                <p id="live-luna-price" class="subtext text-xs font-semibold mt-1 text-gray-500"><i class="fas fa-spinner fa-spin text-gray-500"></i></p>
            </div>
            <div class="stat-card p-6 rounded-xl text-center">
                 <div>
                    <h3 id="avg-daily-gain-title" class="text-md font-medium text-gray-400 flex justify-center items-center gap-2">Avg Daily Gain Per NFT</h3>
                    <p id="avg-daily-gain" class="text-3xl font-bold text-white mt-2"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></p>
                </div>
                <p id="avg-daily-gain-subtext" class="subtext text-xs font-semibold mt-1 text-gray-500"><i class="fas fa-spinner fa-spin text-gray-500"></i></p>
            </div>
        </div>

       <!-- Recent NFT Activity Section REMOVED -->
       
    </main>

    
    <!-- Modals -->
    
    <!-- UNUSED HTML REMOVED: #nft-modal and #share-canvas were here -->


    <div id="daodaoModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-3xl relative text-white opacity-0 scale-95 p-8 flex flex-col"> <!-- Added flex flex-col -->
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold text-cyan-400 mb-4 flex-shrink-0">DAODAO Staking & Supply Details</h3> <!-- Added flex-shrink-0 -->

            <!-- New Detail Section -->
            <div id="supply-breakdown" class="grid grid-cols-2 gap-x-8 gap-y-4 mb-6 p-4 bg-gray-800/50 rounded-lg border border-gray-700 text-sm flex-shrink-0"> <!-- Added flex-shrink-0 -->
                <div class="flex justify-between border-b border-gray-600 pb-2">
                    <span class="text-gray-400">Total Minted:</span>
                    <span id="supply-minted" class="font-bold text-white"><i class="fas fa-spinner fa-spin"></i></span>
                </div>
                <div class="flex justify-between border-b border-gray-600 pb-2">
                    <span class="text-gray-400">DAO Controlled (Broken):</span>
                    <span id="supply-dao-controlled" class="font-bold text-white">1,000</span>
                </div>
                 <div class="col-span-2 border-t border-gray-700 my-2"></div>
                <div class="flex justify-between">
                    <span class="text-gray-400">Circulating Supply:</span>
                    <span id="supply-circulating" class="font-bold text-cyan-400"><i class="fas fa-spinner fa-spin"></i></span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-400">Liquid Supply:</span>
                    <span id="supply-liquid" class="font-bold text-green-400"><i class="fas fa-spinner fa-spin"></i></span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-400">DAODAO Staked:</span>
                    <span id="supply-daodao-staked" class="font-bold text-white"><i class="fas fa-spinner fa-spin"></i></span>
                </div>
                 <div class="flex justify-between">
                    <span class="text-gray-400">Enterprise Staked:</span>
                    <span id="supply-enterprise-staked" class="font-bold text-white"><i class="fas fa-spinner fa-spin"></i></span>
                </div>
            </div>

             <!-- SCROLL FIX: Structure updated for static header -->
             <div class="border-t border-gray-700 pt-4 mt-4 flex flex-col min-h-0">
                <h4 class="font-bold text-lg text-white mb-2 flex-shrink-0">Top DAODAO Stakers (<span id="daodao-modal-holder-count"><i class="fas fa-spinner fa-spin"></i></span> NFTs)</h4>

                <!-- Static Header Table -->
                <div class="bg-gray-900 rounded-t-lg px-4 pt-2 pb-1">
                    <table class="w-full text-left text-sm">
                        <thead>
                            <tr>
                                <th class="p-2 w-3/4">Wallet Address</th>
                                <th class="p-2 w-1/4 text-right">NFTs Staked</th>
                            </tr>
                        </thead>
                    </table>
                </div>

                <!-- Scrollable Body Container -->
                <div class="overflow-y-auto max-h-64 bg-gray-800/50 rounded-b-lg">
                    <div id="daodao-stakers-table" class="px-4 pb-2"> <!-- JS injects table body here -->
                        <div class="text-center p-4"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></div> <!-- Spinner placeholder -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="enterpriseModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-3xl relative text-white opacity-0 scale-95 p-8 flex flex-col"> <!-- Added flex flex-col -->
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold text-cyan-400 mb-4 flex-shrink-0">Enterprise Staking Details</h3> <!-- Added flex-shrink-0 -->
            <div class="space-y-4 text-gray-300 flex flex-col min-h-0"> <!-- Added flex flex-col min-h-0 -->
                <div class="bg-blue-900/30 border border-blue-700 p-3 rounded-lg flex-shrink-0"> <!-- Added flex-shrink-0 -->
                    <p class="font-bold text-lg text-white">Action Required: Migrate Your NFTs</p>
                    <p>The Alliance DAO has officially migrated its governance from Enterprise to DAODAO. Any members who have not yet migrated their NFTs must do so to participate in governance proposals, promotions, and future DAO-distributed rewards.</p>
                </div>
                <a href="tutorials.html" class="inline-block bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg transition-colors mt-2 flex-shrink-0">View Migration Tutorial &rarr;</a> <!-- Added flex-shrink-0 -->
                
                <!-- SCROLL FIX: Structure updated for static header -->
                <div class="border-t border-gray-700 pt-4 mt-4 flex flex-col min-h-0">
                    <h4 class="font-bold text-lg text-white mb-2 flex-shrink-0">Holder Staking on Enterprise (<span id="enterprise-modal-holder-count"><i class="fas fa-spinner fa-spin"></i></span> NFTs)</h4>

                    <!-- Static Header Table -->
                    <div class="bg-gray-900 rounded-t-lg px-4 pt-2 pb-1">
                        <table class="w-full text-left text-sm">
                            <thead>
                                <tr>
                                    <th class="p-2 w-3/4">Wallet Address</th>
                                    <th class="p-2 w-1/4 text-right">NFTs Staked</th>
                                </tr>
                            </thead>
                        </table>
                    </div>

                    <!-- Scrollable Body Container -->
                    <div class="overflow-y-auto max-h-64 bg-gray-800/50 rounded-b-lg">
                        <div id="enterprise-stakers-table" class="px-4 pb-2"> <!-- JS injects table body here -->
                             <div class="text-center p-4"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></div> <!-- Spinner placeholder -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="daoBrokenModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
         <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-2xl relative text-white opacity-0 scale-95 p-8">
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold text-cyan-400 mb-4">DAO Broken/Held NFTs</h3>
            <div class="space-y-4 text-gray-300">
                <p>The DAO currently holds 1,000 broken NFTs which are used for various purposes including liquidity and strategic reserves. These are held across three separate DAO wallets:</p>
                <ul class="list-disc list-inside space-y-2 bg-gray-800/50 p-4 rounded-lg">
                    <li><strong class="text-yellow-400">900 NFTs (Liquid):</strong> Held in two wallets, available for liquidity purposes.
                        <ul class="list-circle list-inside ml-6 text-sm">
                            <li>Wallet ending in: ...8ywv</li>
                            <li>Wallet ending in: ...417v</li>
                        </ul>
                    </li>
                    <li><strong class="text-green-400">100 NFTs (Staked):</strong> Held in the Enterprise staking wallet.
                         <ul class="list-circle list-inside ml-6 text-sm">
                             <li>Wallet ending in: ...6ugw</li>
                         </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    
    <div id="unmintedModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
         <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-2xl relative text-white opacity-0 scale-95 p-8">
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold text-cyan-400 mb-4">Unminted NFT Backing Calculation</h3>
            <div class="space-y-4 text-gray-300">
                <p>This value represents the total backing of all DAO-held NFTs that have not yet been minted. It is calculated by multiplying the total number of unminted NFTs by the live backing value per NFT.</p>
                <div class="bg-yellow-900/30 border border-yellow-700 p-3 rounded-lg text-sm">
                    <p><strong class="text-yellow-300">Important Note:</strong> The backing is a "worst-case" or baseline value. This calculation does not factor in additional value derived from the art, DAO Voting Power (VP), or the ability to stake the NFT to participate in governance and earn DAO-distributed rewards. For context, even a broken NFT has a current floor price of ~249 bLUNA, highlighting the significant value beyond its liquid backing.</p>

                </div>
                <div class="bg-gray-800/50 p-4 rounded-lg mt-4 text-center">
                     <p class="text-lg font-mono">
                        <span id="unminted-modal-count"><i class="fas fa-spinner fa-spin"></i></span> Unminted NFTs * <span id="unminted-modal-backing-luna"><i class="fas fa-spinner fa-spin"></i></span> LUNA
                        <br> = <strong class="text-cyan-400 text-xl" id="unminted-modal-total-luna"><i class="fas fa-spinner fa-spin"></i> LUNA</strong>
                    </p>
                    <hr class="border-gray-600 my-2">
                     <p class="text-lg font-mono">
                        <span id="unminted-modal-count-2"><i class="fas fa-spinner fa-spin"></i></span> Unminted NFTs * $<span id="unminted-modal-backing-usd"><i class="fas fa-spinner fa-spin"></i></span> USD
                        <br> = <strong class="text-cyan-400 text-xl" id="unminted-modal-total-usd"><i class="fas fa-spinner fa-spin"></i> USD</strong>
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <div id="treasuryModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-2xl relative text-white opacity-0 scale-95 p-8">
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold text-cyan-400 mb-4">DAO Treasury Details</h3>
            <div id="treasury-table-container" class="max-h-96 overflow-y-auto">
                 <div class="text-center p-4"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></div> <!-- Spinner placeholder -->
            </div>
            <a href="https://daodao.zone/dao/terra1sffd4efk2jpdt894r04qwmtjqrrjfc52tmj6vkzjxqhd8qqu2drs3m5vzm/treasury?url=https%3A%2F%2Fwww.erisprotocol.com" target="_blank" rel="noopener noreferrer" class="inline-block mt-6 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg transition-colors w-full text-center">
                View Treasury on DAODAO &rarr;
            </a>
        </div>
    </div>
    
    <div id="tlaModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-3xl relative text-white opacity-0 scale-95 p-8 overflow-y-auto">
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold text-cyan-400 mb-4">DAO TLA Deposit Details</h3>
            <div class="text-center bg-gray-800/50 p-4 rounded-lg mb-4">
                 <p class="text-lg">Total Deposit Value (Snapshot)</p>
                 <p class="text-2xl font-bold text-white" id="tla-deposit-total-usd"><i class="fas fa-spinner fa-spin text-white text-2xl"></i></p>
                 <p class="text-md text-cyan-400" id="tla-deposit-total-apr"><i class="fas fa-spinner fa-spin text-cyan-400"></i></p>
                 <div class="mt-2 pt-2 border-t border-gray-600">
                    <p class="text-lg">Unclaimed Rewards</p>
                    <p class="text-xl font-bold text-white" id="tla-unclaimed-rewards"><i class="fas fa-spinner fa-spin text-white text-xl"></i></p>
                 </div>
            </div>
            <div class="bg-yellow-900/30 border border-yellow-700 p-3 rounded-lg text-sm mb-4">
                <p><strong class="text-yellow-300">Disclaimer:</strong> This data is a snapshot from <span id="tla-snapshot-date"></span>. The "Live Estimated Value" for underlying tokens is calculated using live CoinGecko prices and may not perfectly reflect the LP's current balance due to impermanent loss.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-bold text-lg text-white mb-2 text-center">Pools</h4>
                    <div id="tla-pools-container" class="space-y-2"> <div class="text-center p-4"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></div> </div>
                </div>
                <div>
                    <h4 class="font-bold text-lg text-white mb-2 text-center">Underlying Tokens</h4>
                    <div id="tla-tokens-container"> <div class="text-center p-4"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></div> </div>
                </div>
            </div>
             <a href="https://daodao.zone/dao/terra1sffd4efk2jpdt894r04qwmtjqrrjfc52tmj6vkzjxqhd8qqu2drs3m5vzm/apps?url=https%3A%2F%2Fwww.erisprotocol.com" target="_blank" rel="noopener noreferrer" class="inline-block mt-6 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg transition-colors w-full text-center">
                View Deposits on Eris Protocol &rarr;
            </a>
        </div>
    </div>

    <div id="tlaVpModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-4xl relative text-white opacity-0 scale-95 p-8">
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h3 class="text-2xl font-bold text-cyan-400 mb-4">DAO TLA VP Details</h3>
            <div class="space-y-4 text-gray-300">
                <div class="text-center bg-gray-800/50 p-4 rounded-lg">
                    <p class="text-lg">Total Voting Power</p>
                    <p class="text-2xl font-bold text-white">638,880 VP</p>
                    <p class="text-sm text-gray-400 mt-2">Live Underlying Value:</p>
                    <p class="text-lg font-bold text-white" id="tla-vp-modal-luna"><i class="fas fa-spinner fa-spin text-white text-lg"></i></p>
                    <p class="text-md text-cyan-400" id="tla-vp-modal-usd"><i class="fas fa-spinner fa-spin text-cyan-400"></i></p>
                    <p class="text-xs text-gray-500 mt-2">Last Adjusted: September 7th, 2025 (VP is static)</p>
                </div>
                <div id="tla-vp-locks-container">
                      <div class="text-center p-4"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></div> <!-- Spinner placeholder -->
                </div>
                <a href="https://daodao.zone/dao/terra1sffd4efk2jpdt894r04qwmtjqrrjfc52tmj6vkzjxqhd8qqu2drs3m5vzm/apps?url=https%3A%2F%2Fwww.erisprotocol.com" target="_blank" rel="noopener noreferrer" class="inline-block mt-4 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg transition-colors w-full text-center">
                    View Locks on Eris Protocol &rarr;
                </a>
            </div>
        </div>
    </div>

    <div id="logoModal" class="modal fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="modal-content bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-xl w-full max-w-4xl relative text-white opacity-0 scale-95 p-8 text-center">
            <button class="modal-close absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <h2 class="text-3xl font-bold text-white mb-6">Project & Alliance Logos</h2>
            <div id="logo-library-container" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 text-center max-h-96 overflow-y-auto p-4">
                 <div class="text-center p-4 col-span-full"><i class="fas fa-spinner fa-spin text-cyan-400 text-2xl"></i></div> <!-- Spinner placeholder -->
            </div>
            <a href="https://github.com/defipatriot/aDAO-Image-Files" target="_blank" rel="noopener noreferrer" class="inline-block mt-6 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105">
                View Full Library on GitHub
            </a>
        </div>
    </div>


    <footer class="border-t border-gray-800 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-500 text-sm">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div><h4 class="font-bold text-gray-300 mb-2">Disclaimer</h4><p>This website is for informational purposes only and does not constitute financial advice. All data is provided "as is" without warranty. Please do your own research.</p></div>
                <div><h4 class="font-bold text-gray-300 mb-2">Project Origin</h4><p>This site is built and maintained by a council member, not at the direction of the council, but as a passionate community member looking to improve the optics of the collection.</p></div>
                <div><h4 class="font-bold text-gray-300 mb-2">Data Source</h4><p>Data on this site is a mix of live on-chain data and static snapshots. See the banner at the top for details.</p>
                <!-- Removed Last Snapshot Update paragraph -->
                </div>
                <div><h4 class="font-bold text-gray-300 mb-2">Transparency</h4><p>The plan is for the script used to retrieve on-chain data to be open-source. You will be able to view the public repository to see how information is retrieved.</p><a href="https://github.com/defipatriot" target="_blank" rel="noopener noreferrer" class="text-cyan-400 hover:underline mt-2 inline-block">View on GitHub</a></div>
            </div>
        </div>
    </footer>
    
    <!-- New Quick Links Footer -->
    <footer class="py-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-gray-400">
            <div class="flex justify-center items-center space-x-6 mb-4">
                <a href="https://t.me/The_AllianceDAO" target="_blank" rel="noopener noreferrer" class="hover:text-white transition-colors"><i class="fab fa-telegram-plane text-3xl"></i></a>
                <a href="https://x.com/The_AllianceDAO" target="_blank" rel="noopener noreferrer" class="hover:text-white transition-colors"><i class="fab fa-twitter text-3xl"></i></a>
            </div>
            <div class="flex justify-center items-center space-x-6 text-sm">
                <a href="tutorials.html" class="hover:text-white hover:underline transition-colors">Tutorials</a>
                <a href="links.html" class="hover:text-white hover:underline transition-colors">Official Links</a>
                <a href="#" id="logo-modal-trigger" class="hover:text-white hover:underline transition-colors cursor-pointer">Logos</a>
                <a href="https://chainsco.pe/terra2/address/terra1phr9fngjv7a8an4dhmhd0u0f98wazxfnzccqtyheq4zqrrp4fpuqw3apw9" target="_blank" rel="noopener noreferrer" class="hover:text-white hover:underline transition-colors">NFT Contract</a>
                <a href="https://github.com/SCV-Security/PublicReports/blob/b819ec669f81e603caca261931e2a4aaca1cddf7/Alliance/Alliance%20DAO%20-%20NFT%20Collection%20Contract%20-%20Audit%20Report%20v1.0.pdf" target="_blank" rel="noopener noreferrer" class="hover:text-white hover:underline transition-colors">Contract Audit</a>
            </div>
        </div>
    </footer>


    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- UI ELEMENTS ---
            const liveBackingDisplayEl = document.getElementById('live-backing-display'); 
            
            // Phase 1 Elements
            const phase1Bar = document.getElementById('phase1-bar');
            const phase1LabelLow = document.getElementById('phase1-label-low');
            const phase1LabelHigh = document.getElementById('phase1-label-high');
            const phase1LabelBacking = document.getElementById('phase1-label-backing');
            const phase1BackingValueEl = document.getElementById('phase1-backing-value');
            const phase1GainTextEl = document.getElementById('phase1-gain-text'); 

            // Phase 2 Elements
            const phase2Bar = document.getElementById('phase2-bar');
            const phase2LabelMint = document.getElementById('phase2-label-mint');
            const phase2LabelBacking = document.getElementById('phase2-label-backing');
            const phase2BackingValueEl = document.getElementById('phase2-backing-value');
            const phase2GainTextEl = document.getElementById('phase2-gain-text');


            // --- MINT PRICES (Constants) ---
            const mintPricePhase1Low = 50; 
            const mintPricePhase1High = 75; 
            const mintPricePhase2 = 75;

            // --- API Fetch Function ---
            async function fetchLiveBacking() {
                // ... (API URLs remain the same) ...
                 const contractRewardsQuery = btoa(JSON.stringify({ all_nft_info: { token_id: "9068" } }));
                const contractUrl = `https://terra.publicnode.com/cosmwasm/wasm/v1/contract/terra1phr9fngjv7a8an4dhmhd0u0f98wazxfnzccqtyheq4zqrrp4fpuqw3apw9/smart/${contractRewardsQuery}`;
                const ampLunaRateQuery = btoa(JSON.stringify({ exchange_rates: {} }));
                const ampLunaRateUrl = `https://terra.publicnode.com/cosmwasm/wasm/v1/contract/terra10788fkzah89xrdm27zkj5yvhj9x3494lxawzm5qq3vvxcqz2yzaqyd3enk/smart/${ampLunaRateQuery}`;

                try {
                    const [contractResponse, ampLunaRateResponse] = await Promise.all([
                        fetch(contractUrl).catch(e => { console.error("Contract Fetch Error:", e); return null; }),
                        fetch(ampLunaRateUrl).catch(e => { console.error("ampLUNA Rate Fetch Error:", e); return null; })
                    ]);

                    if (!contractResponse?.ok || !ampLunaRateResponse?.ok) {
                        throw new Error("One or more API requests failed");
                    }

                    const contractJson = await contractResponse.json();
                    const ampLunaRateData = await ampLunaRateResponse.json();

                    // --- Process Data ---
                     const rewardsAttribute = contractJson?.data?.info?.extension?.attributes?.find(attr => attr.trait_type === 'rewards');
                     const rewardsValue = rewardsAttribute?.value;
                     const liveAmpLunaBacking = rewardsValue ? Number(rewardsValue) / 1000000 : 0; 
                     const ampLunaToLunaRate = parseFloat(ampLunaRateData?.data?.exchange_rates?.[0]?.[1]);
                     if (isNaN(ampLunaToLunaRate)) {
                         throw new Error("Invalid ampLUNA exchange rate");
                     }
                    const backingInLunaLive = liveAmpLunaBacking * ampLunaToLunaRate;
                    
                    // --- Update UI ---
                    updateGainsAndBars(backingInLunaLive); 

                    // --- Update the debug display ---
                    if (liveBackingDisplayEl) {
                        liveBackingDisplayEl.textContent = `${backingInLunaLive.toFixed(4)} LUNA`; 
                    }

                } catch (error) {
                    console.error("Failed to fetch or process live backing data:", error);
                    // Update UI to show error state for bars and text
                     updateGainsAndBars(null); // Pass null to indicate error

                     // --- Update the debug display on error ---
                     if (liveBackingDisplayEl) {
                         liveBackingDisplayEl.textContent = "Error Fetching LUNA";
                         liveBackingDisplayEl.classList.remove('text-cyan-400'); 
                         liveBackingDisplayEl.classList.add('text-red-400');
                     }
                }
            }

            // --- UPDATE UI FUNCTION for Bars and Gains ---
            function updateGainsAndBars(liveLunaBacking) {
                 const isError = typeof liveLunaBacking !== 'number';

                // Define scale - slightly below lowest mint, slightly above highest value
                const minScale = Math.min(mintPricePhase1Low, mintPricePhase2) * 0.9; 
                const maxScale = Math.max(liveLunaBacking || 0, mintPricePhase1High, mintPricePhase2) * 1.1 || 100; // Ensure not zero if backing fails
                const range = maxScale - minScale;
                 if (range <= 0) return; // Avoid division by zero

                 // Helper to calculate percentage position, clamped between 0 and 100
                 const perc = (value) => Math.max(0, Math.min(100, ((value - minScale) / range) * 100));

                 // --- Update Phase 1 ---
                 if (phase1Bar && phase1LabelLow && phase1LabelHigh && phase1LabelBacking && phase1BackingValueEl && phase1GainTextEl) {
                     if (isError) {
                         phase1Bar.innerHTML = `<div class="h-full flex items-center justify-center text-xs text-red-400">Error</div>`;
                         phase1LabelLow.style.opacity = '0';
                         phase1LabelHigh.style.opacity = '0';
                         phase1LabelBacking.style.opacity = '0';
                         phase1GainTextEl.textContent = 'Error calculating gain.';
                         phase1GainTextEl.className = 'text-xs text-center text-red-400 mt-1';
                     } else {
                         const p1LowPerc = perc(mintPricePhase1Low);
                         const p1HighPerc = perc(mintPricePhase1High);
                         const p1BackingPerc = perc(liveLunaBacking);
                         const gainHigh = liveLunaBacking - mintPricePhase1High;
                         const gainLow = liveLunaBacking - mintPricePhase1Low;

                         phase1Bar.innerHTML = ''; // Clear spinner/error

                         // Determine bar segments and colors
                         if (liveLunaBacking < mintPricePhase1Low) { // Loss vs Low
                            phase1Bar.innerHTML = `<div class="backing-bar-segment bg-red-500 rounded-l-full" style="width: ${p1BackingPerc}%;"></div>`;
                         } else if (liveLunaBacking < mintPricePhase1High) { // Between Low and High
                            phase1Bar.innerHTML = `
                                <div class="backing-bar-segment bg-blue-600 rounded-l-full" style="width: ${p1LowPerc}%;"></div>
                                <div class="backing-bar-segment bg-yellow-500" style="width: ${p1BackingPerc - p1LowPerc}%;"></div>
                             `;
                         } else { // Gain vs High
                             phase1Bar.innerHTML = `
                                <div class="backing-bar-segment bg-blue-600" style="width: ${p1LowPerc}%;"></div>
                                <div class="backing-bar-segment bg-blue-400" style="width: ${p1HighPerc - p1LowPerc}%;"></div>
                                <div class="backing-bar-segment bg-green-500 rounded-r-full" style="width: ${p1BackingPerc - p1HighPerc}%;"></div>
                             `;
                         }

                         // Update Label Positions and Values
                         phase1LabelLow.style.left = `${p1LowPerc}%`;
                         phase1LabelHigh.style.left = `${p1HighPerc}%`;
                         phase1LabelBacking.style.left = `${p1BackingPerc}%`;
                         phase1BackingValueEl.textContent = liveLunaBacking.toFixed(2);
                         phase1LabelLow.style.opacity = '1';
                         phase1LabelHigh.style.opacity = '1';
                         phase1LabelBacking.style.opacity = '1';

                         // Update Summary Text
                         const gainHighColor = gainHigh >= 0 ? 'text-green-300' : 'text-red-400';
                         const gainLowColor = gainLow >= 0 ? 'text-green-300' : 'text-red-400';
                          phase1GainTextEl.innerHTML = `Gain: <span class="font-bold ${gainHighColor}">${gainHigh.toFixed(2)}</span> (vs 75) / <span class="font-bold ${gainLowColor}">${gainLow.toFixed(2)}</span> (vs 50) LUNA`;
                         phase1GainTextEl.className = 'text-xs text-center text-gray-400 mt-1'; // Reset class
                     }
                 }

                 // --- Update Phase 2 ---
                  if (phase2Bar && phase2LabelMint && phase2LabelBacking && phase2BackingValueEl && phase2GainTextEl) {
                     if (isError) {
                          phase2Bar.innerHTML = `<div class="h-full flex items-center justify-center text-xs text-red-400">Error</div>`;
                          phase2LabelMint.style.opacity = '0';
                          phase2LabelBacking.style.opacity = '0';
                          phase2GainTextEl.textContent = 'Error calculating gain.';
                          phase2GainTextEl.className = 'text-xs text-center text-red-400 mt-1';
                     } else {
                         const p2MintPerc = perc(mintPricePhase2);
                         const p2BackingPerc = perc(liveLunaBacking);
                         const gainPhase2 = liveLunaBacking - mintPricePhase2;

                         phase2Bar.innerHTML = ''; // Clear spinner/error

                          // Determine bar segments and colors
                         if (gainPhase2 < 0) { // Loss vs Mint
                             phase2Bar.innerHTML = `<div class="backing-bar-segment bg-red-500 rounded-l-full" style="width: ${p2BackingPerc}%;"></div>`;
                         } else { // Gain vs Mint
                             phase2Bar.innerHTML = `
                                <div class="backing-bar-segment bg-blue-500 rounded-l-full" style="width: ${p2MintPerc}%;"></div>
                                <div class="backing-bar-segment bg-green-500 rounded-r-full" style="width: ${p2BackingPerc - p2MintPerc}%;"></div>
                             `;
                         }

                         // Update Label Positions and Values
                         phase2LabelMint.style.left = `${p2MintPerc}%`;
                         phase2LabelBacking.style.left = `${p2BackingPerc}%`;
                         phase2BackingValueEl.textContent = liveLunaBacking.toFixed(2);
                         phase2LabelMint.style.opacity = '1';
                         phase2LabelBacking.style.opacity = '1';

                         // Update Summary Text
                         const gainColor = gainPhase2 >= 0 ? 'text-green-300' : 'text-red-400';
                         phase2GainTextEl.innerHTML = `Gain Over Mint (75 LUNA): <span class="font-bold ${gainColor}">${gainPhase2.toFixed(2)}</span> LUNA`;
                          phase2GainTextEl.className = 'text-xs text-center text-gray-400 mt-1'; // Reset class
                     }
                 }
            }

            // --- INITIALIZE THE PAGE by fetching live data ---
            fetchLiveBacking(); 
        });
    </script>

</body>
</html>

